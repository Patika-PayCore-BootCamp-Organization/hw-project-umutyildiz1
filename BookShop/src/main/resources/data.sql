DROP TABLE IF EXISTS Customer CASCADE;
DROP TABLE IF EXISTS Book CASCADE;
DROP TABLE IF EXISTS Cart CASCADE;
DROP TABLE IF EXISTS Cart_Book CASCADE;
DROP TABLE IF EXISTS Category CASCADE;

CREATE TABLE Customer
(

    id      INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name    VARCHAR(50),
    surname VARCHAR(50)

);

CREATE TABLE Book
(
    ISBN INT PRIMARY KEY,
    author_name VARCHAR(255),
    title VARCHAR(255) NOT NULL,
    price INT DEFAULT 0 NOT NULL,
    customer_id INT NOT NULL,
    category_id INT NOT NULL

);

CREATE TABLE Cart
(
    id INT NOT NULL PRIMARY KEY,
    customer_id INT NOT NULL
);

CREATE TABLE Cart_Book
(
    cart_id INT NOT NULL,
    ISBN INT NOT NULL,
    PRIMARY KEY(cart_id,ISBN)
);

CREATE TABLE Category
(
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255)
);

-- FOREIGN KEY CONSTRAINTS

ALTER TABLE Book
ADD CONSTRAINT fk_book_customer FOREIGN KEY (customer_id) REFERENCES Customer(id);
ALTER TABLE Book
ADD CONSTRAINT fk_book_category FOREIGN KEY (category_id) REFERENCES Category(id);

ALTER TABLE Cart
ADD CONSTRAINT fk_cart_user FOREIGN KEY (customer_id) REFERENCES Customer(id);

ALTER TABLE Cart_Book
ADD CONSTRAINT fk_cart_book_cart FOREIGN KEY (cart_id) REFERENCES Cart(id);
ALTER TABLE Cart_Book
ADD CONSTRAINT fk_cart_book_book FOREIGN KEY (ISBN) REFERENCES Book(ISBN);

-- FAKE DATAS INSERTION